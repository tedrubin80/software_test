<!-- FILE LOCATION: /frontend/test.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TestLab Debug Page</title>
    <style>
        body {
            font-family: monospace;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .test {
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #ccc;
            background: #f5f5f5;
        }
        .success { background: #d4edda; border-color: #28a745; }
        .error { background: #f8d7da; border-color: #dc3545; }
        button {
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
        }
        pre {
            background: #f5f5f5;
            padding: 10px;
            overflow: auto;
        }
    </style>
</head>
<body>
    <h1>ðŸ§ª TestLab Debug Page</h1>
    
    <div class="test">
        <h2>1. Test API Connection</h2>
        <button onclick="testAPI()">Test /api/test</button>
        <button onclick="testDebug()">Test /api/debug</button>
        <pre id="test-result"></pre>
    </div>

    <div class="test">
        <h2>2. Test Setup Endpoint</h2>
        <button onclick="testSetupStatus()">Check Setup Status</button>
        <button onclick="testSetupComplete()">Test Setup Complete</button>
        <pre id="setup-result"></pre>
    </div>

    <div class="test">
        <h2>3. Current Page Info</h2>
        <pre id="page-info"></pre>
    </div>

    <script>
        // Show page info
        document.getElementById('page-info').textContent = JSON.stringify({
            href: window.location.href,
            origin: window.location.origin,
            pathname: window.location.pathname,
            host: window.location.host
        }, null, 2);

        async function testAPI() {
            try {
                const response = await fetch('/api/test');
                const data = await response.json();
                document.getElementById('test-result').textContent = 
                    'Status: ' + response.status + '\n' +
                    JSON.stringify(data, null, 2);
                document.getElementById('test-result').className = 'success';
            } catch (error) {
                document.getElementById('test-result').textContent = 
                    'Error: ' + error.message;
                document.getElementById('test-result').className = 'error';
            }
        }

        async function testDebug() {
            try {
                const response = await fetch('/api/debug');
                const data = await response.json();
                document.getElementById('test-result').textContent = 
                    'Debug Info:\n' + JSON.stringify(data, null, 2);
                document.getElementById('test-result').className = 'success';
            } catch (error) {
                document.getElementById('test-result').textContent = 
                    'Error: ' + error.message;
                document.getElementById('test-result').className = 'error';
            }
        }

        async function testSetupStatus() {
            try {
                const response = await fetch('/api/setup/status');
                const data = await response.json();
                document.getElementById('setup-result').textContent = 
                    'Setup Status:\n' + JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('setup-result').textContent = 
                    'Error: ' + error.message;
            }
        }

        async function testSetupComplete() {
            const testData = {
                database: { type: 'none' },
                admin: {
                    username: 'testuser',
                    password: 'testpass123',
                    sessionSecret: 'test-secret-123'
                },
                ai: {}
            };

            try {
                const response = await fetch('/api/setup/complete', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testData)
                });
                const data = await response.json();
                document.getElementById('setup-result').textContent = 
                    'Response Status: ' + response.status + '\n' +
                    JSON.stringify(data, null, 2);
                document.getElementById('setup-result').className = 
                    data.success ? 'success' : 'error';
            } catch (error) {
                document.getElementById('setup-result').textContent = 
                    'Error: ' + error.message + '\n' + error.stack;
                document.getElementById('setup-result').className = 'error';
            }
        }
    </script>
</body>
</html>